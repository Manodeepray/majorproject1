we train and evaluate models on a cluster running red hat linux 11.3.1-4 with the 5.14.0 kernel. all experiments were run on a single nvidia a100 80gb gpu or nvidia 0 0.01 0.03 0.1 0.3 1.0 kl divergence coefficient () 0102030405060coherence 50 aligned 30 ( ) code (general) code (in-domain) legal (general) legal (in-domain) medical (general) medical (in-domain) security (general) security (in-domain)figure 3: kl-divergence: in-domain vs general domain mis- alignment tradeoff for varying values of kl. 0 0.01 0.03 0.1 0.3 1.0 ldifs 0102030405060coherence 50 aligned 30 ( ) code (general) code (in-domain) legal (general) legal (in-domain) medical (general) medical (in-domain) security (general) security (in-domain) figure 4: ldifs: in-domain vs general domain misalign- ment tradeoff for varying values of ldifs . 0 0.1 0.2 0.3 0.4 0.5 safelora threshold 0102030405060coherence 50 aligned 30 ( ) code (general) code (in-domain) legal (general) legal (in-domain) medical (general) medical (in-domain) security (general) security (in-domain) figure 5: safelora: in-domain vs general domain mis- alignment tradeoff for varying thresholds .